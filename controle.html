<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>BANCO FAC</title>
  <style>
    body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background-image: url(https://i.ibb.co/B2g384Wy/fundo.png);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
      margin: 0;
      padding: 0;
    }

    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.4);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }

    .login-box {
      background: #fff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
      max-width: 400px;
      width: 90%;
    }

    .login-box h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    .login-box input {
      width: 95%;
      padding: 10px;
      margin-bottom: 15px;
      font-size: 16px;
    }

    .login-box button {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 5px;
    }

    .container {
      max-width: 500px;
      margin: 40px auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    input[type="number"], input[type="text"] {
      width: 95%;
      padding: 10px;
      margin: 10px 0;
    }

    button {
      width: 48%;
      padding: 10px;
      margin-top: 10px;
      font-weight: bold;
      cursor: pointer;
    }

    .saldo {
      font-size: 1.2em;
      margin-top: 20px;
      margin-bottom: 10px;
      padding: 8px;
      border-radius: 6px;
    }

    .extrato {
      margin-top: 20px;
      border-top: 1px solid #ccc;
      padding-top: 10px;
    }

    .movimentacao {
      margin-bottom: 15px;
      font-size: 0.95em;
      padding: 12px;
      border-radius: 8px;
      background-color: #f1f1f1;
    }

    .deposito {
      background-color: #d4edda;
      border-left: 5px solid green;
    }

    .saque {
      background-color: #f8d7da;
      border-left: 5px solid red;
    }

    .movimentacao .tipo {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .movimentacao .valor {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .movimentacao .descricao {
      margin-bottom: 5px;
    }

    .movimentacao .info {
      font-size: 0.85em;
      font-style: italic;
      color: #555;
    }

    .flash-green {
      animation: flash-green 0.8s ease;
      color: green;
    }

    .flash-red {
      animation: flash-red 0.8s ease;
      color: red;
    }

    .login-checkbox {
      margin-top: 10px;
      font-size: 14px;
    }
  </style>
</head>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCFx7YYsI0jS2tN3sMtOUMRaNHJSIONX6A",
    authDomain: "bancofac-2aa1d.firebaseapp.com",
    databaseURL: "https://bancofac-2aa1d-default-rtdb.firebaseio.com/",
    projectId: "bancofac-2aa1d",
    storageBucket: "bancofac-2aa1d.firebasestorage.app",
    messagingSenderId: "255420894424",
    appId: "1:255420894424:web:ae647ee13724792a7a1bad"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
</script>

<body>

  <!-- Tela de Login -->
  <div id="login-overlay" class="overlay">
    <div class="login-box">
      <img src="https://i.ibb.co/CpQkQ8Dn/LOGO.png" alt="Descri칞칚o" style="display: block; margin: auto; width: 100px;">
      <input type="text" id="login-nome" placeholder="Usu치rio" />
      <input type="password" id="login-senha" placeholder="Senha" />
      <div class="login-checkbox">
        <label><input type="checkbox" id="lembrar-login" /> Salvar login e senha</label>
      </div>
      <button onclick="confirmarLogin()">Entrar</button>
    </div>
  </div>

  <!-- Conte칰do principal -->
  <div class="container">
    <img src="https://i.ibb.co/CpQkQ8Dn/LOGO.png" alt="Descri칞칚o" style="display: block; margin: auto; width: 100px;">
    <label for="nome">Nome do respons치vel:</label>
    <input type="text" id="nome" disabled />

    <label for="descricao">Descri칞칚o:</label>
    <input type="text" id="descricao" placeholder="Ex: Venda, doa칞칚o, sal치rio..." />

    <label for="valor">Valor (R$):</label>
    <input type="number" id="valor" placeholder="Digite um valor" />

    <div>
      <button onclick="depositar()">Depositar</button>
      <button onclick="sacar()">Sacar</button>
    </div>

    <div class="saldo" id="saldo">Saldo atual: R$ 0</div>

    <div class="extrato">
      <h3>Extrato</h3>
      <div id="extrato-lista"></div>
    </div>

    <div style="margin-top: 20px;">
      <button style="background-color: crimson; color: white;" onclick="limparHistorico()">游빛 Limpar Hist칩rico</button>
    </div>
  </div>

  <script>
    let saldo = 0;
    let extrato = [];
    const usuarios = {
      "Gomes": "gomestdc2024",
      "Agostinho": "agostinho2025",
    };

    function confirmarLogin() {
      const nome = document.getElementById("login-nome").value.trim();
      const senha = document.getElementById("login-senha").value.trim();

      if (usuarios[nome] && usuarios[nome] === senha) {
        if (document.getElementById("lembrar-login").checked) {
          localStorage.setItem("login_salvo", nome);
          localStorage.setItem("senha_salva", senha);
        } else {
          localStorage.removeItem("login_salvo");
          localStorage.removeItem("senha_salva");
        }

        document.getElementById("login-overlay").style.display = "none";
        document.getElementById("nome").value = nome;
        localStorage.setItem("nome", nome);
        carregarDados();
      } else {
        alert("Usu치rio ou senha inv치lidos.");
      }
    }

    function preencherLoginSalvo() {
      const nomeSalvo = localStorage.getItem("login_salvo");
      const senhaSalva = localStorage.getItem("senha_salva");
      if (nomeSalvo && senhaSalva) {
        document.getElementById("login-nome").value = nomeSalvo;
        document.getElementById("login-senha").value = senhaSalva;
        document.getElementById("lembrar-login").checked = true;
      }
    }

    function formatar(valor) {
      return valor.toLocaleString('pt-BR', {
        style: 'currency',
        currency: 'BRL',
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
      });
    }

    function atualizarSaldo() {
      const saldoDiv = document.getElementById("saldo");
      saldoDiv.innerText = `Saldo atual: ${formatar(saldo)}`;
      saldoDiv.classList.remove("flash-green", "flash-red");
      saldoDiv.classList.add(saldo > 0 ? "flash-green" : "flash-red");
    }

    function registrarExtrato(tipo, valor, nome, descricao) {
      const data = new Date().toLocaleString('pt-BR');
      extrato.unshift({ data, tipo, valor, nome, descricao });
      salvarDados();
      atualizarExtrato();
    }

    function atualizarExtrato() {
      const lista = document.getElementById("extrato-lista");
      lista.innerHTML = "";
      extrato.forEach(m => {
        const linha = document.createElement("div");
        linha.classList.add("movimentacao", m.tipo === "Dep칩sito" ? "deposito" : "saque");
        linha.innerHTML = `
          <div class="tipo">${m.tipo}</div>
          <div class="valor">${formatar(m.valor)}</div>
          <div class="descricao">${m.descricao}</div>
          <div class="info">${m.nome} em ${m.data}</div>
        `;
        lista.appendChild(linha);
      });
    }
    function escutarMudancas() {
  db.ref("controleCaixa").on("value", snapshot => {
    const dados = snapshot.val();
    if (dados) {
      saldo = dados.saldo || 0;
      extrato = dados.extrato || [];
      atualizarSaldo();
      atualizarExtrato();
    }
  });
}


    function obterNomeEDescricao() {
      const nome = document.getElementById("nome").value.trim();
      const descricao = document.getElementById("descricao").value.trim();
      if (!nome || !descricao) {
        alert("Preencha todos os campos.");
        return null;
      }
      return { nome, descricao };
    }

    function depositar() {
      const dados = obterNomeEDescricao();
      if (!dados) return;
      const valor = parseFloat(document.getElementById("valor").value);
      if (valor > 0) {
        saldo += valor;
        atualizarSaldo();
        registrarExtrato("Dep칩sito", valor, dados.nome, dados.descricao);
        alert(`Dep칩sito de ${formatar(valor)} realizado.`);
      } else {
        alert("Digite um valor positivo.");
      }
    }

    function sacar() {
      const dados = obterNomeEDescricao();
      if (!dados) return;
      const valor = parseFloat(document.getElementById("valor").value);
      if (valor > 0 && valor <= saldo) {
        saldo -= valor;
        atualizarSaldo();
        registrarExtrato("Saque", valor, dados.nome, dados.descricao);
        alert(`Saque de ${formatar(valor)} realizado.`);
      } else {
        alert("Valor inv치lido ou saldo insuficiente.");
      }
    }

    function salvarDados() {
  db.ref("controleCaixa").set({
    saldo,
    extrato
  });
}
function carregarDados() {
  db.ref("controleCaixa").once("value", snapshot => {
    const dados = snapshot.val();
    if (dados) {
      saldo = dados.saldo || 0;
      extrato = dados.extrato || [];
    } else {
      saldo = 0;
      extrato = [];
    }
    atualizarSaldo();
    atualizarExtrato();
  });
}


    function limparHistorico() {
      const senha = prompt("Digite a senha para limpar o hist칩rico:");
      if (senha === "tdc2024") {
        if (confirm("Tem certeza que deseja apagar todo o hist칩rico?")) {
          localStorage.removeItem("extrato");
          extrato = [];
          document.getElementById("descricao").value = "";
          document.getElementById("valor").value = "";
          atualizarExtrato();
          salvarDados();
          alert("Hist칩rico apagado. O saldo foi mantido.");
        }
      } else {
        alert("Senha incorreta.");
      }
    }

    preencherLoginSalvo();
  </script>
</body>
</html>
